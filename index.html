<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="index.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <div id="header">
            <h1 id="pageHeader">Resmark API Demonstration</h1>
        </div>
        <div id="body">
            <!-- Token -->
            <div class="section">
                <h3 class="sectionHeader">Get a JWT Token</h3>
                <p class="description">
                     When using the Resmark API you will first need to authenticate your user by obtaining a JWT Token. 
                     This token will be used in every call made to the API to ensure the security of the information 
                     being retrieved. To get this token please invoke the authentication endpoint of the Resmark API while 
                     passing in a username and the API Key of your business, which can be found in your API settings.
                </p>   
                <div class="container">
                    <form id="userDetails" class="contentBox" name="userForm">
                        <label for="username">Username</label><br><br>
                        <input type="text" id="username" name="username"><br><br>
                        <label for="key">API Key</label><br><br>
                        <input type="text" id="key" name="key"><br><br>
                        <input type="submit" value="Get Token" class="button" id="submitToken" onclick="returnToken(username.value, key.value); return false">
                    </form>
                    <div id="result" class="contentBox">
                        <p id="tokenHeader">Your JWT Token</h5>
                        <p id="jwtToken"></p>
                    </div>
                </div>
                <div class="container">
                    <button class="button getCodeButton" id="getTokenCode">
                        Show API Call
                        <i id="jwtArrow" class="arrow down"></i>
                    </button>
                    <div class="codeSection" id="tokenCode">
                            <pre>
                              <code>
                                function getToken(username, key) {
    
                                    //CREATING THE API BODY USING THE USERNAME AND API KEY THAT WAS COLLECTED ABOVE
                                    const body = {
                                        username: username,
                                        apikey: key
                                    };
                                    const json = JSON.stringify(body);
                                    
                                    //MAKING THE API REQUEST, SETTING THE HEADER TYPE AND SENDING THE BODY OF THE REQUEST
                                    const jwtToken = new XMLHttpRequest();
                                    jwtToken.open("POST", "https://app.resmarksystems.com/public/api/authenticate",false);
                                    jwtToken.setRequestHeader('Content-type','application/json; charset=utf-8');
                                    jwtToken.send(json);
                                    
                                    //CREATING THE VARIABLE WHICH HOLDS THE API'S RESPONSE TEXT (THE TOKEN)
                                    token = jwtToken.responseText;
                                
                                    //RETURNING THE TOKEN TO THE CALLING FUNCTION
                                    return(jwtToken.responseText);
                                }
                              </code>
                            </pre>
                    </div>
                </div>
            </div>

            <!-- Display each product with there name, descripition and image. (each product is a link when  clicked it populates the next section) -->
            <div class="section">
                <h3 class="sectionHeader">Show a List of Products</h3>
                <p class="description">
                     After obtaining your authorization token you can then start to interact with the other API endpoints. In the following example, we will
                     pass the JWT Token obtained above to get a list of all the products in our business, along with some select meta data about each of those products. 
                     Once we have that information we can then format and display those products to the customer. Click 'Show My Products' below to invoke 
                     the Product endpoint of the API and then select a product from the list.
                </p>
                <button id="showProducts" class="button getCodeButton">Show My Products</button>
                <div class="container contentBox" id="productsContainer"></div>

                <div class="container">
                    <button class="button getCodeButton" id="getProductsCode">
                        Show API Call
                        <i id="productsArrow" class="arrow down"></i>
                    </button>
                    <div class="codeSection" id="productsCode">
                            <pre>
                              <code>
                                function getProducts(token) {
    
                                    //MAKING THE REQUEST, SETTING THE HEADERS AND SENDING THE BODY OF THE REQUEST
                                    const products = new XMLHttpRequest();
                                    products.open("GET", "https://app.resmarksystems.com/public/api/product",false);
                                    products.setRequestHeader('Content-type','application/json; charset=utf-8');
                                    
                                    //USES THE TOKEN OBTAINED ABOVE FOR ACCESS
                                    products.setRequestHeader('Authorization',`Bearer ${token}`); 
                                    products.send();
                                
                                    //PARSING THE RESPONSE TEXT TO TURN IT INTO JSON FROM A STRING
                                    const parsedResponse = JSON.parse(products.responseText);
                                
                                    //ISOLATING THE 'DATA' ARRAY WHICH CONTAINS THE PRODUCTS AND ALL OF THEIR META DATA
                                    const productArray = parsedResponse.data;
                                
                                    //RETURN THE PRODUCT ARRAY TO THE CALLING FUNCTION
                                    return(productArray);
                                }
                              </code>
                            </pre>
                    </div>
                </div>
            </div>

            <!-- Show selected Product and input fields for the date and participants. when entered Show Times Available for date entered when time selected go to next section-->
            <div class="section" id="selectDateSection">
                <h3 class="sectionHeader">Select a Date and Add Participants</h3>
                <p class="description">This is a description</p>

                <div class="container contentBox" id="selectedProduct">

                </div>

                <div class="container">
                    <button class="button getCodeButton" id="getDateAndPartCode">
                        Show API Call
                        <i id="dateAndPartArrow" class="arrow down"></i>
                    </button>
                    <div class="codeSection" id="dateAndPartCode">
                            <pre>
                              <code>
                                
                              </code>
                            </pre>
                    </div>
                </div>
            </div>

            <!-- Collect the customers information -->
            <div class="section">
                <h3 class="sectionHeader">Collect the Customers Information</h3>
                <p class="description">This is a description</p>

                <div class="container">
                    <button class="button getCodeButton" id="getCustomerCode">
                        Show API Call
                        <i id="customerArrow" class="arrow down"></i>
                    </button>
                    <div class="codeSection" id="customerCode">
                            <pre>
                              <code>
                                
                              </code>
                            </pre>
                    </div>
                </div>
            </div>

            <!-- Create the order -->
            <div class="section">
                <h3 class="sectionHeader">Create and then Display the Order</h3>
                <p class="description">This is a description</p>
                
                <div class="container">
                    <button class="button getCodeButton" id="getOrderCode">
                        Show API Call
                        <i id="orderArrow" class="arrow down"></i>
                    </button>
                    <div class="codeSection" id="orderCode">
                            <pre>
                              <code>
                                
                              </code>
                            </pre>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript" src="index.js"></script>
        <script type="text/javascript" src="showCode.js"></script>
    </body>
</html>